schema: '2.0'
stages:
  data_ingestion:
    cmd: python3 src/data/data_ingestion.py
    deps:
    - path: src/data/data_ingestion.py
      hash: md5
      md5: fbb3439a898afd4b3ba0d7444108c6ad
      size: 7122
    params:
      params.yaml:
        data_ingestion.predict_size_authentic: 0.05
        data_ingestion.predict_size_fraud: 0.05
        data_ingestion.test_size_authentic: 0.25
        data_ingestion.test_size_fraud: 0.5
        data_ingestion.train_size_authentic: 0.55
        data_ingestion.train_size_fraud: 0.15
        data_ingestion.val_size_authentic: 0.15
        data_ingestion.val_size_fraud: 0.3
    outs:
    - path: data/original
      hash: md5
      md5: 686b5cc46feda58c546491746e9c963e.dir
      size: 324805985
      nfiles: 1
    - path: data/raw
      hash: md5
      md5: 0f8156b8edf5b952a42e59dd7dbe28a1.dir
      size: 317395219
      nfiles: 4
  data_preprocessing:
    cmd: python3 src/data/data_preprocessing.py
    deps:
    - path: data/raw/predict.csv
      hash: md5
      md5: 27362361d2731d66477576bd4c00438a
      size: 15871407
    - path: data/raw/test.csv
      hash: md5
      md5: 186c3f59173869650924e17e4ad5c8f2
      size: 119107092
    - path: data/raw/train.csv
      hash: md5
      md5: 7982e0af4a51bfcd0500f728b8e80f68
      size: 110952393
    - path: data/raw/val.csv
      hash: md5
      md5: ee8923a7e3839fb884c633c31e177419
      size: 71464327
    - path: src/data/data_preprocessing.py
      hash: md5
      md5: 97d4b0ef2f5d77891398bf22c1ec2743
      size: 5894
    params:
      params.yaml:
        data_preprocessing.scaler_method: standardscaler
    outs:
    - path: artifacts/scaler.pkl
      hash: md5
      md5: e9f05d503a7ae734c0cca386529e38ed
      size: 1711
    - path: data/processed
      hash: md5
      md5: a9a2b04b8bb2693eb532af8b3654f6a1.dir
      size: 326718138
      nfiles: 4
  model_building:
    cmd: python3 src/model/model_building.py
    deps:
    - path: data/processed/train_processed.csv
      hash: md5
      md5: c1df6e45ac83b85f78ac50ea5e0eb0ce
      size: 114782142
    - path: data/processed/val_processed.csv
      hash: md5
      md5: fe516f726ee1f52d436d6e77ae51a05f
      size: 73348763
    - path: src/model/model_building.py
      hash: md5
      md5: c69fa63ecbf4bf8241977aff4625bd3a
      size: 8274
    params:
      params.yaml:
        model_building.models:
          logistic_regression:
            class: sklearn.linear_model.LogisticRegression
            params:
              C: 1.0
              max_iter: 1000
              random_state: 42
              n_jobs: -1
          random_forest:
            class: sklearn.ensemble.RandomForestClassifier
            params:
              n_estimators: 200
              max_depth: 10
              random_state: 42
              n_jobs: -1
          gradient_boosting:
            class: sklearn.ensemble.HistGradientBoostingClassifier
            params:
              max_iter: 200
              learning_rate: 0.1
              max_depth: 10
              random_state: 42
          lgbm:
            class: lightgbm.LGBMClassifier
            params:
              n_estimators: 300
              learning_rate: 0.05
              random_state: 42
              n_jobs: -1
          xgboost:
            class: xgboost.XGBClassifier
            params:
              n_estimators: 300
              learning_rate: 0.05
              random_state: 42
              n_jobs: -1
    outs:
    - path: models/saved_models/
      hash: md5
      md5: dcbb5c9f232bbaab425546bf84627303.dir
      size: 9626557
      nfiles: 15
  model_evaluation:
    cmd: python3 src/model/model_evaluation.py
    deps:
    - path: data/processed/test_processed.csv
      hash: md5
      md5: c17fd5130cdcb2aa9d89924e7ade928e
      size: 122250170
    - path: data/processed/val_processed.csv
      hash: md5
      md5: fe516f726ee1f52d436d6e77ae51a05f
      size: 73348763
    - path: models/saved_models
      hash: md5
      md5: dcbb5c9f232bbaab425546bf84627303.dir
      size: 9626557
      nfiles: 15
    - path: src/model/model_evaluation.py
      hash: md5
      md5: 230d618d4a54583756673b298be8e305
      size: 35698
    params:
      params.yaml:
        model_evaluation.experiment_name: credit-card-fraud
        model_evaluation.selection:
          mode: combined
          num_classes: 2
          combined_overall_weight: 0.4
          overall:
            accuracy: 0.0
            recall: 0.0
            precision: 0.0
            f1_score: 0.0
            roc_auc: 1.0
          specific:
            1_recall: 3
            1_precision: 2
            0_recall: 0
            0_precision: 0
        model_evaluation.tracking_uri: 
          https://dagshub.com/takenking9879/MLOPS-project-Credit-Card-Fraud-Detection.mlflow
    outs:
    - path: models/best_model.json
      hash: md5
      md5: c335424c45c09bec263d81d8a648b4c9
      size: 999
    - path: models/confusion_matrices/
      hash: md5
      md5: c9f3cf367f07921f2db4b76cd7924131.dir
      size: 119039
      nfiles: 5
    - path: models/metrics
      hash: md5
      md5: 9c2af5f5f7c79ab8e78e9d69ce801cf3.dir
      size: 9742
      nfiles: 6
    - path: models/selection_summary.json
      hash: md5
      md5: 46eb0dc02fd4f350cfae5b253c5d6fb4
      size: 1278
  model_final:
    cmd: python3 src/model/model_final.py
    deps:
    - path: data/processed/test_processed.csv
      hash: md5
      md5: c17fd5130cdcb2aa9d89924e7ade928e
      size: 122250170
    - path: src/model/model_final.py
      hash: md5
      md5: 6d849becda0d406c5ec32cc11bcf5516
      size: 6485
    params:
      params.yaml:
        model_final.model_name: gradient_boosting_20250909_132623
        model_final.output_metrics_path: models/final_model/metrics.json
        model_final.output_model_path: 
          models/final_model/gradient_boosting_20250909_132623.pkl
        model_final.test_path: data/processed/test_processed.csv
    outs:
    - path: models/final_model/metrics.json
      hash: md5
      md5: b19d9862d5ae9c2108beb92fbd6bcdb5
      size: 169
